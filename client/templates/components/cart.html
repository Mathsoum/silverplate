{% verbatim %}
Vue.component('cart-item',{
	props: ['ingredient'],

	template: '<li> \
	{{ingredient.description}} <button class="btn btn-success" v-on:click="AddItem"> Add </button> \
	</li> ',
	methods: {
		AddItem: function(){
			this.$emit('AddItem');
		}
	}
})

Vue.component('cart', {
	template: ' \
	<div id="cart"> \
		<div v-show="SelectedIngredients.length > 0"> \
		{{SelectedTitle}}\
		<li> \
			<ul v-for="i in SelectedIngredients"> \
				<cart-item :ingredient="i" v-on:AddItem="Add(i)" ></cart-item> \
			</ul> \
		</li> \
		</div> \
		{{Title}} \
		<input type="text" v-model="ingredient_search" id="ingredient_search" v-on:blur="LoadData" /> \
		<li> \
			<ul v-for="i in Ingredients"> \
				<cart-item :ingredient="i" v-on:AddItem="Add(i)" ></cart-item> \
			</ul> \
		</li> \
	</div>',
	data: function(){
		return {
			Ingredients: [],
			SelectedIngredients: [],
			Title: "Carrinho de ingredients",
			SelectedTitle: "Selecionados",
			ingredient_search: ''
		}
	},
	created: function ()  { 
	    this.LoadData();
	},
	methods: {
		LoadData: function(){
		var self = this;
		var q = '';
		if(self !== undefined && self.ingredient_search !== undefined){
			q = '?q='+self.ingredient_search;
		}
		 $.ajax({
		            url: 'http://127.0.0.1:8000/api/ingredient' + q,
		            method: 'GET',
		            success: function (data) {
		                self.Ingredients = data;
		            },
		            error: function (error) {
		                alert(JSON.stringify(error));
		            }
		        });
		},
		Add: function(p){
			var c = 0;
			for(var c = 0; c < this.Ingredients.length; c++){
				if(this.Ingredients[c].id == p.id)
					this.Ingredients.splice(c, 1);
			}
			this.SelectedIngredients.push(p);
		}
	}
});
{% endverbatim %}